var _0xod0='jsjiami.com.v6',_0xod0_=['‮_0xod0'],_0xfacb=[_0xod0,'ZSVHwp/Dlw==','w7NGcA==','w4YdeMO+RcKWem8VJw==','w5YjBz11','w6gGOA4=','wozCm1PCjcOO','wrFRMMOZa8O9wosUw5E+w6zDq8OqTHdbwr/DucKvwpI2XsOow58Uw6ZDGH/CicK7w7Bvf3zCkcKywo3DjsKoUF1VYx7DuBvDu8K9BsKBw4LCqMKqw6vCt8O1woTDrl0eJlMww6VYYsO1a17CliPCoCNbwqLDpsKGSsK/cWLDgxLDv8KnF8OBEzI5wrXDncKeO1zDoyR0w6UJw6LDgD7CtxTCoDLCt196S8Orw6okPMKUw5pUw7PDjTA2w73CkmzDrGI1ZsO+w7Z3wqLCoB7DuTXCh8OAw70ZDcOeasKjc8KOA2rCusKweC3DnWfDh8OkT8KhHDrCnmzDjXvCoMKWGcKJw4rDvMOLw5ojwqDCo8K1D2LCpHEiDnDDmcO/wrRbw6c3wq/CvsKDw4XCuXwzM8Odw7VefCHDrlAAwoLCksOwwrjCpm4HdcORwqzDisOiw454wrp6wr3DjcKFw7jCgBbDp8KpwpDDj8OMfzIlEH1OSGTDtRnCjsKmX8OGw53Dq8KBBStqUxguZsOHME/CrMOBFsKBZMOEw4vDqmVTw6l6OsO4SB1YesKcw45rEMOQw4Itc8OyacO+ZsK5wr0gw6DDtlohw4xbw7Aow43DjMKvwr5xw6zCi8KdGsKcVcOiw7DCsDTDlGvCg3Mywp3CuMK1NyJcw6rDs2vDhcKyw4LCscOSV8OJw43DujHCiz/CvcOIwrTDm8K0w7jDo8KQLRUdAsK6ADFZw7DCigJQw7DCmA7DgUHDvw0iOVnDqQgNwpTCqsKqwpHCvcOVw755wrLDvXnDr8OrPAbCvT0+SCXCncKdw7Apw6V9w4HCncOmMMOMw6I+w6dLw59MFlvDgMOfaMOQax9iw4oXOMKIN8OCwpw5w5DCoEQEZUTDjjTCr8K8a8OfIAZmUXwaw7I1OcK+c8KTJXrCjV46DsKlw6Q0bMKtw77DssO7T8KXZMOwF2hVwpjCrTzDusKEwrdyC8KzJUcjAcO9OsOFw7PDijUQQVMiXzNAISQJbCYDw7JdcsK8R1zDssK/w4jDm0EXTwZFacKswqF2ZQrCpsOzeSLCvsKHf8KkwoTCkMO9wqPDl8OGYxhuwohsZnkFT8OZw5odecOQw5DDvFs5wqXCu8KswpnCuhjDhCocw4TCrhEQF8KXw4fCpMKNbGDClsK2wp3DjcOTw5nCtOe6oOacl+WBpeitqOaUpsKxwrfClMK1NMKTw7/DmkfCiQTnpblFXWh+wrzDtAhoJ1vCoXo/IcObZcK9O8Oyf2dTWcK4w7PCgy3CksO8BMOLQ8KyJTxrw48jwphvNMKwCsOLGmTDtkQCECccwoTDmhsUfsOLw7NrWWLDqsO0w750LcK/YT4Lw58eVA1Kw5pkHcOXYTPDl8OkwoPDrsOxw73DkFbCvMKRwq0uYsOQKFYOWgzDvXBOw6HDrcOwdCIjw7zCisOKwqBMw6DDrSB5anHCscKMw5HCsMORwrhvIw/Cv1rCuAfCnsONw4fDg8OzcTnDpMO5fFdRwo9Cw4sTeWvCnT43wpjCtEfCl8OLwonCjgPCqn3CpMKcw5XCsAkvF8KReQotwoNiwoPDucKYHgZGEMO4I8Kiw5XCl8KSWVbDo8KVEDrClcKMAl0iwqghRV0xwpcrwpkwaMOuwoFgw6hUBWTConDDuMKfwovCpMOawoDDsyTDiMKYcsO7wqfCrMOtw707w6B/DjzCq8OeBcKbKsK1wrXDksOwVsOf','wofCrmnDngs=','w69HT3PCsV/Dow==','w7kPLBvDjsOB','w7XDpcOHw4lm','woEVdsO5S8OLew==','wqs1ek0BfnE=','wotLAcOnAg==','D1bDgGs5','XMKgw6VNEmMp','wovDscOWw7ca','wrwWwrg=','wrdfHcKiOg==','wpLCtsOieiY=','JyTCuMKo','w5MUccKdLsKvw5g=','5p+p5qKQ5p++5YiZ5b+h6Le/6L2u55uw5byY5L2G5pSi56iaw6R0Ne+/msK5','QSNZwqXDgkEn','wrrCvnfCsg==','O0/Dp8OVw64=','w6nCgS03w7k=','wr/Dr8O9wr9j','w5YWQ8KQBA==','wqxkCMOqAg==','HTPDhg==','5p2D5qOa5py05Yiu5b+J6LaY6L2v55uY5byf5L+f5pWr56i7HRbChe+8kcOF','w7rCmBLCoWfDnAo=','worCixXDpMKYw5vDo2A=','MXIgI8OR','wqJgwovDhMOv','w6HDr8OIQTM=','wod+esKJw5LCmEh+wqPCj8O+w63DmsOAwqHCpMKzbcKAw6treWjDv8KLw7QHB3rDrmJFCsOCwrPCsXnCt3HDrxnDlMOfMlTCv8Kww7/CgcOaw6fCsTvDhsKjdSLDhlbDg8O1HMO7wrhQc8ObRMOtHnfDtcOUw4haK8KFwrQNw45twqxCw4/Dlg/Ch2fDqcOew4FQTn/CisKHYsKIJsKABcK/w6B6wo7DicK3wr4SDjnDoMKLJnjDhMOIw5bDpcOkwqwpwqM4wqg6w44sZcKyWsKWw51yw6jDi8K+QCRYWsKLUSzCmD7CmcOYwpogJgrDux1Fw79aUHLCqlzDuMKECjzCqMKfDMOvMjjCl8Kmb15DwrpSwr/DlcOFIlEiw7fDg8K7w7TCucKrL3HDl8ORw4RfTcO5a8K3YcKFO3nDqcOdbXzDkcOMIBPDuG7Dn8O+wrnCksOWc3UNG8Kxw60wFcKiworDqVjCmFXCgznCgXnDuHc1EcKzEcOnw4vCiMKVNsKVdxrDvG3Dp8OLw5VxYcOSw6B8CcK5w4jCq1VJw7/ChsO+HcOIwoXDpcKuwq0+w6sGw7xwwrtpPkTCvcOUDsOaeG1KRTXCkQjDkcKLw60ZXhnCkMKawqzCjTNwwqJYNsOWwoJUMsOOF8O4YcKVw67CmsObZULDohDDrEFqw7YSIzc+wojCnMKyYXEmEsK9d25pw4wLKMOcbinDncOtAMKtw5zDjEsbw6l4XMOPUgRLYDc0c8OFKsOZw7vDjSHCv8KowpcDw6TDisOlJsKZV0Adw6s1UWPDqcOPcy3DgMOqXCJCCsK+RmPCh2LDtzQLw4TDl8OOH8KNwrhCe0jDrAp0F8OtQ8KiYDXCh8OcNMKcMsKOQAUUw4wBwrDDlCwwaMOGVkXDt2PDscKzRAU6aMOsDMKweTnDgsK0wq9wwrbCtcO7w4nCjX3CosO2wotWwpsPwpVeC8OtwrEOw7LDqMKrw5nDl0/Cq8ODIErCiD7CqsOmS0PCjcOaw4Imw5DDj8KYLG8KwqPCoS9Sw7kuYAVVwppWNMKPLsOkfGMZRG7DkFvDrcKBKsOaw5FZesK8w6AQwovDvsKyw4hTwpDDnMOlw6R1w7rDswsbw7bClmPDo8OYwpIjLSQbwqjCtcKrXsOyPMOPwrTDgw1BwpbCgFNRwqbDjn3CkyrCqFbnupPmnbPlgLLoraTmlpZaK8KlK1LCnw7DlSnCksO+56WEw5QoAwcHw43Coj4MwqnCkUfDrsKUXcK4wobDv2/CrMOFw4I2fsKRP3jDkRTDsMKlJMO6wpRjKFzDsiDDsRF2XcO1GcO/M213QMKVwrnCtC/DgioQD14nOCTDl8OYGx9sEcOaUMOUQmcVVyLCnFDDgwHCt07DjsKSwpTCmiTCrcOAwqzDqh3CsTHCrUl0w7XCvMOTODLDs8KJfsOVb8Klw7xbw5DCsFAnw4VXeUnCmkd8Z2pcBcKIw4vCtsKew63DgMO/N3PDpMK7W8O/JsOyRsKuw4XDmMKWPBh4wo3Dl8KqUVZkwolIw63DiGfDllTCtn3CksOuw6cjBsOIKcOXSMOfw4TDqFHDj1BOwqVOT8K0w7VPw6R3w4TDr2tnE24MZMKbw6xfw6gOw4XCq8OfZMOtG8O+w704HsOswoRwwo3CpmFMF0jCkMK8w6RkwonDu10lw6N7OMKywqFjwrQlworDpm9UIcOFKFpfZAHDtcOYwrvDpsOJLgM=','wrtBwqLDncO4','w4FFXWTCpA==','wrPDk8OWwp5CPjI=','dRYFa8OYw6c=','TD9mwrU=','AGnCgGstBVs=','w4I2Ki7DjQ==','GTnDgF7CuMOow5c=','w4QVw5U=','w44hDypV','wofCg8O+UQ==','5p6F5qCS5pyd5Ymt5b+u6LW/6L6H55qO5b2/5L635pSH56qsBlnDju+9oMOU','w4ITw4sSU8KAw5DCrcOr','woTDucOxwpDDtMOUOg==','EXnCvykoIlA=','wojDt8OLw6IZMEA=','w5Zmw5PCqX7Ct1/Dl8OMMkfCkGV0QMOuw6lQw4c=','wpl/bsKU','w7vDhMORw43DpsKBw7M=','RMONw43DqcOo','wqULwrPDnFfDvg==','w7TClB3CpG7DggA=','CcKuw4wYccOuw5HDvMKCwo4Ew6HDg3ZR','w4pbf2fCt1HDqcO9','w5kvw4V4aVXDr2VPwqzCvMOQw5nDu8OSw40Hw4Mw','w7LDpMOew6ps','w48UaMKNZMK1w59Fw5VxwqHDpMK8JyUIw7rCrcKyw4d+UMKgwoY=','AMOwwqrCqAw=','w4oVc8KhKA==','w4nCiQkBw6M=','w7nDlcOCTzc=','w5zDm8OJw4jDiA==','wpTDngpzw7s=','Y8OBw4/DmsOv','jsIFjiVampDi.cbXomIuM.v6JSwZku=='];if(function(_0x25d00d,_0x5773e8,_0xb7d2a3){function _0x52ed40(_0xb9da6d,_0x22cb3d,_0x113048,_0x1a8dbf,_0x4ad8fe,_0x456c80){_0x22cb3d=_0x22cb3d>>0x8,_0x4ad8fe='po';var _0x3df76e='shift',_0x28fa26='push',_0x456c80='‮';if(_0x22cb3d<_0xb9da6d){while(--_0xb9da6d){_0x1a8dbf=_0x25d00d[_0x3df76e]();if(_0x22cb3d===_0xb9da6d&&_0x456c80==='‮'&&_0x456c80['length']===0x1){_0x22cb3d=_0x1a8dbf,_0x113048=_0x25d00d[_0x4ad8fe+'p']();}else if(_0x22cb3d&&_0x113048['replace'](/[IFVpDbXIuMJSwZku=]/g,'')===_0x22cb3d){_0x25d00d[_0x28fa26](_0x1a8dbf);}}_0x25d00d[_0x28fa26](_0x25d00d[_0x3df76e]());}return 0xea5b3;};return _0x52ed40(++_0x5773e8,_0xb7d2a3)>>_0x5773e8^_0xb7d2a3;}(_0xfacb,0xcc,0xcc00),_0xfacb){_0xod0_=_0xfacb['length']^0xcc;};function _0x48df(_0x45bb63,_0x1d0be9){_0x45bb63=~~'0x'['concat'](_0x45bb63['slice'](0x1));var _0x302129=_0xfacb[_0x45bb63];if(_0x48df['BRfHvi']===undefined){(function(){var _0x18d8dc=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x21fc7f='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x18d8dc['atob']||(_0x18d8dc['atob']=function(_0x1a892d){var _0x5d5162=String(_0x1a892d)['replace'](/=+$/,'');for(var _0x5e2060=0x0,_0x1fbb3d,_0x446f1a,_0x420925=0x0,_0x245c32='';_0x446f1a=_0x5d5162['charAt'](_0x420925++);~_0x446f1a&&(_0x1fbb3d=_0x5e2060%0x4?_0x1fbb3d*0x40+_0x446f1a:_0x446f1a,_0x5e2060++%0x4)?_0x245c32+=String['fromCharCode'](0xff&_0x1fbb3d>>(-0x2*_0x5e2060&0x6)):0x0){_0x446f1a=_0x21fc7f['indexOf'](_0x446f1a);}return _0x245c32;});}());function _0x5c312e(_0x3388ce,_0x1d0be9){var _0xb2e211=[],_0x12e3e2=0x0,_0x25a78a,_0x1425d0='',_0x3430a7='';_0x3388ce=atob(_0x3388ce);for(var _0x4a2fda=0x0,_0x38e0fa=_0x3388ce['length'];_0x4a2fda<_0x38e0fa;_0x4a2fda++){_0x3430a7+='%'+('00'+_0x3388ce['charCodeAt'](_0x4a2fda)['toString'](0x10))['slice'](-0x2);}_0x3388ce=decodeURIComponent(_0x3430a7);for(var _0x5b861a=0x0;_0x5b861a<0x100;_0x5b861a++){_0xb2e211[_0x5b861a]=_0x5b861a;}for(_0x5b861a=0x0;_0x5b861a<0x100;_0x5b861a++){_0x12e3e2=(_0x12e3e2+_0xb2e211[_0x5b861a]+_0x1d0be9['charCodeAt'](_0x5b861a%_0x1d0be9['length']))%0x100;_0x25a78a=_0xb2e211[_0x5b861a];_0xb2e211[_0x5b861a]=_0xb2e211[_0x12e3e2];_0xb2e211[_0x12e3e2]=_0x25a78a;}_0x5b861a=0x0;_0x12e3e2=0x0;for(var _0x473b1=0x0;_0x473b1<_0x3388ce['length'];_0x473b1++){_0x5b861a=(_0x5b861a+0x1)%0x100;_0x12e3e2=(_0x12e3e2+_0xb2e211[_0x5b861a])%0x100;_0x25a78a=_0xb2e211[_0x5b861a];_0xb2e211[_0x5b861a]=_0xb2e211[_0x12e3e2];_0xb2e211[_0x12e3e2]=_0x25a78a;_0x1425d0+=String['fromCharCode'](_0x3388ce['charCodeAt'](_0x473b1)^_0xb2e211[(_0xb2e211[_0x5b861a]+_0xb2e211[_0x12e3e2])%0x100]);}return _0x1425d0;}_0x48df['JsGiSP']=_0x5c312e;_0x48df['bdKprX']={};_0x48df['BRfHvi']=!![];}var _0x363f59=_0x48df['bdKprX'][_0x45bb63];if(_0x363f59===undefined){if(_0x48df['bcjAhN']===undefined){_0x48df['bcjAhN']=!![];}_0x302129=_0x48df['JsGiSP'](_0x302129,_0x1d0be9);_0x48df['bdKprX'][_0x45bb63]=_0x302129;}else{_0x302129=_0x363f59;}return _0x302129;};const $=new Env('前台自动阅读');!(async()=>{var _0x240a7a={'RJJZl':_0x48df('‮0','GMlD'),'qcmyb':_0x48df('‫1','pN3l'),'BHYAG':_0x48df('‫2','34OW'),'qZrNv':'/mock/read','jjfOv':_0x48df('‮3','g!rF'),'GqAbg':_0x48df('‫4','lA&L'),'OzyaK':function(_0x5b4b55,_0x18f568){return _0x5b4b55!==_0x18f568;},'Dhozx':'undefined','DmvPo':function(_0x1d07d2,_0x39ea1c){return _0x1d07d2!==_0x39ea1c;},'RaOip':_0x48df('‮5','fzI5'),'ZJQVg':_0x48df('‮6','lA&L'),'ZQQzi':'nZpVF','QOLbS':function(_0x2eaf66,_0x32194d){return _0x2eaf66!==_0x32194d;},'eOxTS':function(_0x3dbd1f,_0x59d612){return _0x3dbd1f===_0x59d612;},'mgSiO':_0x48df('‮7','qylF'),'VLdtb':_0x48df('‫8','9B1R'),'rVZHQ':function(_0x39e48c,_0x45ef11){return _0x39e48c!==_0x45ef11;}};if(_0x240a7a[_0x48df('‫9','4W4q')](typeof $request,_0x240a7a[_0x48df('‮a','&WFd')])){if(_0x240a7a[_0x48df('‮b','BGn(')](_0x240a7a['RaOip'],_0x48df('‫c','OKGB'))){if($request[_0x48df('‮d','pN3l')]['indexOf'](_0x48df('‫e','uf0u'))>0x0){if(_0x240a7a['DmvPo'](_0x240a7a['ZJQVg'],_0x240a7a[_0x48df('‫f','L8AH')])){$[_0x48df('‮10','L8AH')]({'status':_0x240a7a[_0x48df('‮11','W&0*')],'headers':headers,'body':body});}else{let _0x23ef61=_0x48df('‫12','lA&L');const _0x2b613c={'Connection':_0x240a7a[_0x48df('‮13','EaM1')],'Content-Type':_0x240a7a['GqAbg']};if($[_0x48df('‫14','pN3l')]()||$[_0x48df('‮15','uCa4')]()){if(_0x240a7a[_0x48df('‮16','g!rF')](_0x240a7a['ZQQzi'],'XkXjc')){$['done']({'response':{'status':0xc8,'headers':_0x2b613c,'body':_0x23ef61}});}else{let _0x22380a=$response[_0x48df('‮17','uf0u')]&&$response[_0x48df('‫18','vgLT')][_0x240a7a[_0x48df('‫19','HZgG')]]||'';if(_0x22380a[_0x48df('‫1a','!IF@')](/https?:\/\/mp.weixin.qq.com\/s/)){$response[_0x48df('‫1b','FtST')][_0x240a7a[_0x48df('‮1c','F&nJ')]]=$request[_0x48df('‮1d','rCHS')]['replace'](_0x240a7a[_0x48df('‫1e','zsVn')],_0x240a7a[_0x48df('‮1f','BO@@')]);$[_0x48df('‫20','A&8s')]({'headers':$response[_0x48df('‮21','lA&L')]});}else{$['log'](_0x48df('‮22','vgLT')+JSON['stringify']($response['headers'],null,0x2));}}}else if($[_0x48df('‫23','OKGB')]()){$[_0x48df('‫24','W&0*')]({'status':_0x240a7a[_0x48df('‮25','!VhX')],'headers':_0x2b613c,'body':_0x23ef61});}}}else if(_0x240a7a[_0x48df('‮26','qylF')](typeof $response,'undefined')){if(_0x240a7a[_0x48df('‫27','qqwJ')](_0x240a7a[_0x48df('‫28','lA&L')],_0x240a7a[_0x48df('‮29','HZgG')])){$[_0x48df('‫2a','b@s]')](_0x48df('‮2b','928Z')+JSON['stringify']($response[_0x48df('‫2c','OJ[J')],null,0x2));}else{let _0x38439e=$response['headers']&&$response['headers'][_0x48df('‫2d','yuwy')]||'';if(_0x38439e[_0x48df('‫2e','V^Us')](/https?:\/\/mp.weixin.qq.com\/s/)){if(_0x240a7a['rVZHQ'](_0x48df('‫2f','Z3lY'),_0x48df('‫30','9B1R'))){let _0x465e5e=_0x48df('‮31','[&yG');const _0xf2ab43={'Connection':_0x240a7a[_0x48df('‮32','Z3lY')],'Content-Type':_0x240a7a[_0x48df('‮33','pN3l')]};if($[_0x48df('‮34','qqwJ')]()||$[_0x48df('‫35','Annp')]()){$[_0x48df('‮36','OKGB')]({'response':{'status':0xc8,'headers':_0xf2ab43,'body':_0x465e5e}});}else if($[_0x48df('‮37','928Z')]()){$['done']({'status':_0x240a7a[_0x48df('‮38','uCa4')],'headers':_0xf2ab43,'body':_0x465e5e});}}else{$response[_0x48df('‮39','b@s]')][_0x240a7a['qcmyb']]=$request[_0x48df('‫3a','4Vdn')]['replace'](_0x240a7a[_0x48df('‫3b','L8AH')],_0x240a7a['qZrNv']);$[_0x48df('‮3c','BO@@')]({'headers':$response['headers']});}}else{$['log'](_0x48df('‮3d','i@4O')+JSON[_0x48df('‫3e','4Vdn')]($response[_0x48df('‮3f','49bL')],null,0x2));}}}}else{$response[_0x48df('‫40','k@OB')][_0x240a7a[_0x48df('‫19','HZgG')]]=$request['url'][_0x48df('‫41','F&nJ')](_0x48df('‮42','^IWB'),_0x240a7a['qZrNv']);$[_0x48df('‫43','yY9)')]({'headers':$response[_0x48df('‮44','4W4q')]});}}})()[_0x48df('‫45','BGn(')](_0x267ef5=>$[_0x48df('‮46','rCHS')](_0x267ef5))[_0x48df('‫47','OJ[J')](()=>$['done']());;_0xod0='jsjiami.com.v6';
function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`\ud83d\udd14${this.name}, \u5f00\u59cb!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}isShadowrocket(){return"undefined"!=typeof $rocket}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),a={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(a,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:i,...r}=t;this.got[s](i,r).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t.stack):this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
