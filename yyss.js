var _0xodF='jsjiami.com.v6',_0xodF_=['‮_0xodF'],_0x2c33=[_0xodF,'w5/CusOew4ZcAQ8=','KENPwofCmw==','GMOJw5EPeQ==','KSDCmEvDthzCsw==','JcOhw7I6fsOIw6M=','w5ZPUx0X','w4kvwq4=','Y23CiDwIwqfCsw==','wq/CmMKUwrUo','YsOpw7w9cMKVw6IfGcOg','w5LCpsOhw5Y=','BxNE','5p+s5qO+5p2l5YmB5b+36La76L6s55uH5b+x5L+q5pWO56uFwpjDq8Oc77++KA==','wpzCi8Kfw5HCg8KwfA==','wrPCjcOOwp8=','Iyh3fGHDksOJw5HDpcKjwo5rHCbDmQ==','ZAvCgTvDog==','w4B8YCY3','wqzCl8KjYMO5','w5sTwogJYQ==','aMO+ZMOjPHs4','wq5GNcOAMQ==','bcO6ccOkMQ==','AxlCSCvCkcKU','QRXChRvDnA==','dkvDug==','w65xwrlyw4Qnfw==','w64yQcKgw7zCksO6w6cOw6bDmyQfWnYBw5DCscOr','w57CucO8w4DDo8OpYmTCgsOD','EFLDs8O6','wq/CoFzCsgFBIg==','cELDhA==','5p+J5qGt5p+h5Ymo5b6O6Laj6Lyb55uo5byK5L2M5pe456meJhxX776Vw64=','wrJpSsK8w7zCmsO9w60e','Vj3CkSHCtzvChA==','w53DtMO8w5NEw63DkcKuCF7CqmwmXcKGwooNdV1Fw4DDv8KwBmvCqF0EWMOLbcOxw78dZcKfHiPDpmTDsMKkw5oSecKew6rDiTLCsMKITMOCwrfDtXIRw612w6Egw4jCqsK/w4/Clyd9eSMKwrvDjDIbIRMWC8OrwrHCoi7ClsOVwrx5FMO3WXU7F8K2woBACzXCuyDDuMO8NsKoa8Kiwp7CrsKkXSY0Y8O0FGF/wqrCkMKNU1oAw6oYwq8OwpMJU8O6w53DiTMZfnPDmcKrc3Ejwp3DrcOaS8KWw43CsU3CrsKjw6kYQR/DlMKnPEDDqScuw7bDvsOTTAYfw47DgMKZG8OUw5YbPcO3w5wSYH/CqT/DmcK3wovDmyXCpMKswoNNGMOSPcKoP8K8LjkXBHfDvcO6wplKS1EywpJwwqbCjsOpwrYCQlBePRwzcMOuw7DChivCokjDmTfCrMKCZ8OBacOKJnjCtHkRGzXDpcOLMG9Mw4lLwr7CgMOgQ8Ojw7ZdeGh0HcKrwoEBOGPDplcRw5khwpzDrcKjw5zDu8K3w4PDtMKZNcOnwrpBMQ7DlDnCjEcPwr5rwrTCu8KnwozCu8KqXA3Cs8KFcF5OJMK0w6RzN0rDoAzDlMKTN0PDiRIpMTDDicOOQMKhw4XDtkPCkcOXwoUkIsKSw7/Ds2LDjD3DhcOFwpEpY8KeNSfCjsKQdARew4jCunY1HcKxFcKaRSnCm8KIwrzCkCLDvMOuwrnCqsOxZHbDliXCjsKnw7/CgcOdw5DDq8OrIx/Dsl7DvMOvw53CmS8LasOhw5vCucKYwqrCjxvCtSrDmRbCvhXDimcTwqvDsCTDtWzDgS9Nw7vCrlTCgMO6wqDCtcKNeSoVV8KCw4zCp8OIwogISMKqwrzDl8OtAcKvw6TDhSNnUy4fFMOlw6fDusKOTxdzIsO6KU9MwrLDsG8YwrksAC3Ck8OHbMKOwpYUwp3DsBXDqcOrKsKVw6DClsOBw6V3wozCnD3DnVLDhcOUw4jDsMO6w78XXl5ww7EUPl3DjcK6KcKAwpZBU3DDtB9Iw7c5eg8XwrkQw5nCnGrCrBPDlcK7BcKrGWnCicOrRcKHQ8OBwrgOwpgKKMKHwrXDsMOVG8Kvwr1gwp7CmR3DmsKyE8OmIcOmDMO8E2/DrcO0WsO/V8O4BMKhHyrDj8KG57mW5p2b5YC36K+s5pauwqvDoxcHwpDDnXXCm33DlFXnp4fCjhPCvzJmwqI+D0hUU8KLEg86wrTCj8O2AMKZworCmGrDiycTwqfDvcOQw7zCmCoXwqBlF8Owwp5SR0LDoWfDs2cBw5JJw7MtDG8IRgbCmcK2w4t5LsOAw5oawq3CojDCn8O3wr/CiQxZw4kHb8KdRsOFUcOdwpnDmsK8AicAw6jCk8Kqw7XCmSV5wqkKw4FPP8KqCcOjwpF/w45Bw5JhdMKtIsKBw57ChsOTw7Iyw7xuFcKCYkrDiHvDlC3DhMO4woQtw7diK8OwwrPDlcODw7nDkF8cwoRUw6w8F8KjBDbCvsOJwoTCpzDCsi0PEDcaDFLDj8OKf0coPsOkw4BDAgZkYsK/PsKywrDCtRMQWXwbw67DtsO6JlLCsho9w7oaw4PCm8K2w5Uew65KYsOGeiEewpXClnzDs1DCg8K3wr3DllNjw5zDszvCunAQACUPw7nDmcKALyNPwpZ/L8OUX8KlwoQjN8KCw7bCusKLMsKywoAUbsKMw68=','U8KcIkcj','eHvCqyUbwqPCsw==','ZMOFPzsZaMKQ','NW/Chggf','wrvDuT7DucOTGcOZ','wq7CtsKcbA==','5YqN5Y+o6IeX5Ym56Zqy6KyE','wrDDg8Kuw6BpIwnCsw==','XcKQfS5yGMODwqPCvSTDsR/CrW5Owr/DhWDDoVoywqxow4A=','woh7SxwTScKTwpbDvMKw','woRFVMKxw4A=','w6JJw5khwp3DisKhw7gb','w4PCtXzCgcK9','dMOIXQ==','U2TCtzIY','NHjDkGXDsmnDl8ObbTwowqYODxnCm8O8YMOmUUImwoHDrAxLw7vDtMKlIXPDhSIjw7Utw5Zaw5UqPcOMw50dZ8Ocwp/DojHCssOUw67Cq8OWMAMTw6vCqsKoDkLDjsOuw7YhQcKEZDRxKsKYIghCw78jw7TDpMO5VXHDlsKUBTDCscKgL1rDkTliw6QBwpPDtCjDkMOyU8OlT33Dp27Dti/DmyXDtF0Nw6JzTcKXIVLCjW/DrcO4EsO3w5bDrsOyw5cnVsKzXF4nw6vCuMOpw4sMw5kVHsOiXFXDm8OYwqvDo2IEw7rCqH0CUcKwFWFbwow7SB5RUsOwwrzCj8K0OcO7w7PCtMKxwqpoW8KkS03DixFFw6/CisKCwrgIwrRhDcOQMlfDvARGUMOXwo0oCMKtw6bDqMORwpVqw4/Cq8O7wrdDfh/DriwLw5bDq3Qcd8OjAwDDo3pqw6ptw5/DqMO8dsOHwrNIW8OrwpHClB0Vw67DksKMwrrDncK7wrfDocOaw4jDhW7ClkhnDMOMwoDDh8KGJz0DDjzCokwDwrnCggRzM8KnLMKmwrJ0w7EvTGEJWhPDgsOFw7HDpsK4w5LDqRB/wpDCqk/Duk8lw5HCgXMeTHnCilgtGhI7w7XCjMKMGBLCtMK+cTNLw7M6w5oew6J3w5PCuTXCnVNNwrApHsKrEQ4OwrnDoGTCi8ObwplAbsKswoQew7o3wqHCksOhw6AUGWnDlMO3w7HChsKyHMOiw5fCu8K+wpXCmMKsX8Kww65YecOHIcOcIDLCnnvDjMKCw5bCsxM/EhVgcMKQWcKHHcOPCMKyFMOrTGvDoMOaQTrCnsO/woNJwoPDucOqGMKJw5Vhw5rDnsOow6jDg3PDmMKIHlJyFVjDv1nCrVBNXybCkGsLw5J/cMK0w4YVeHLDkDd7w5LDqcK1WX/CocOAwo3DvnPDhcKmw6ZLw63CjT54QxYZw5pkAsOOwp7DmWjDryFLw4jCrsKcFSPCvsORw7zCnsK1w7jDncKOaFfDgnbCkyzDisOywrfDvhQlw7Quw63Dq8OYwrVCaiJWO8KZwrY3wq3DhsOtWBBJwronMsKzwqlWw6rDoUbDlRkyw4jDqcKOwr/DkcO1w4TDv0UbDioxw4ZiXUxCwqEPTmDClsKePBojwoRiw6PDs2HCmMK+Y8Oj57iG5p6s5YOP6K2h5pSjw4XCusOAw7VKw6VeI2rDnS3npKvCjlhffMOlwrRxOMO4LMKMP8OjbHNMwq8QHwQgw49bLsKDwojDtDFXScOtw7JsMkbCjcKow7DDscKBw4TCt0XDu8OTSj9Vw4/CsTnCuMOiLcKpw6VPw6Vzw7vDncOEe8KIPhZEbCNSwo1Nw6gOXsOWwpvCnzJRCzkIwoZzKnrDhsK2w6/CvMKUwrXDjMKVLMOZZGstwrA2wo5dwrrCnE3CtSsvwpxwwqQBw63ChXjDn8KVwrdUM8KKQ39yEm1ow6/DjT1uw5kpRzlIOsOxVsKHfz0DQVBTHMOiw5RsUMKWeCfCjy54IsKYwqA9QgPCtcKiw45ZUgoJwqnCnsOBVMOOwph0w6Y0w79ww4EUPBwXB8K8BMKHAWYWdG4bKyxdw5xBwrNtWcOnW8ORwoQfwr3DrknDoH/DkCwmwo7Cu8OJAW/Dt8KOw6XDrklIKcKAw6vDsULDpFlzw50Uw7JOw7dycgRlWx/Cr2DDglc=','C8O5G8K7wpY=','wq9Nw4weHSY=','VzjsfpkIjifamiJ.HJcnpomHy.pnvK6=='];if(function(_0x18243d,_0xa11a30,_0xc4960d){function _0x6ca862(_0x466928,_0x5ccf34,_0x267fdb,_0x183888,_0x3e3ad3,_0x4466e4){_0x5ccf34=_0x5ccf34>>0x8,_0x3e3ad3='po';var _0x23baca='shift',_0xdcb35b='push',_0x4466e4='‮';if(_0x5ccf34<_0x466928){while(--_0x466928){_0x183888=_0x18243d[_0x23baca]();if(_0x5ccf34===_0x466928&&_0x4466e4==='‮'&&_0x4466e4['length']===0x1){_0x5ccf34=_0x183888,_0x267fdb=_0x18243d[_0x3e3ad3+'p']();}else if(_0x5ccf34&&_0x267fdb['replace'](/[VzfpkIfJHJnpHypnK=]/g,'')===_0x5ccf34){_0x18243d[_0xdcb35b](_0x183888);}}_0x18243d[_0xdcb35b](_0x18243d[_0x23baca]());}return 0xe878c;};return _0x6ca862(++_0xa11a30,_0xc4960d)>>_0xa11a30^_0xc4960d;}(_0x2c33,0xcc,0xcc00),_0x2c33){_0xodF_=_0x2c33['length']^0xcc;};function _0x2fe3(_0x3116d3,_0x270de0){_0x3116d3=~~'0x'['concat'](_0x3116d3['slice'](0x1));var _0x2bfaab=_0x2c33[_0x3116d3];if(_0x2fe3['ZjFOYi']===undefined){(function(){var _0x2801d6=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x257376='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x2801d6['atob']||(_0x2801d6['atob']=function(_0x562fd0){var _0x3ac0ad=String(_0x562fd0)['replace'](/=+$/,'');for(var _0x3017e1=0x0,_0x37df46,_0x118f34,_0x10fc3c=0x0,_0x2b278f='';_0x118f34=_0x3ac0ad['charAt'](_0x10fc3c++);~_0x118f34&&(_0x37df46=_0x3017e1%0x4?_0x37df46*0x40+_0x118f34:_0x118f34,_0x3017e1++%0x4)?_0x2b278f+=String['fromCharCode'](0xff&_0x37df46>>(-0x2*_0x3017e1&0x6)):0x0){_0x118f34=_0x257376['indexOf'](_0x118f34);}return _0x2b278f;});}());function _0x2d8473(_0x3cc487,_0x270de0){var _0x11705d=[],_0x32103c=0x0,_0x4b9233,_0x400726='',_0x3c5552='';_0x3cc487=atob(_0x3cc487);for(var _0x1c2152=0x0,_0x2a3649=_0x3cc487['length'];_0x1c2152<_0x2a3649;_0x1c2152++){_0x3c5552+='%'+('00'+_0x3cc487['charCodeAt'](_0x1c2152)['toString'](0x10))['slice'](-0x2);}_0x3cc487=decodeURIComponent(_0x3c5552);for(var _0x2535e0=0x0;_0x2535e0<0x100;_0x2535e0++){_0x11705d[_0x2535e0]=_0x2535e0;}for(_0x2535e0=0x0;_0x2535e0<0x100;_0x2535e0++){_0x32103c=(_0x32103c+_0x11705d[_0x2535e0]+_0x270de0['charCodeAt'](_0x2535e0%_0x270de0['length']))%0x100;_0x4b9233=_0x11705d[_0x2535e0];_0x11705d[_0x2535e0]=_0x11705d[_0x32103c];_0x11705d[_0x32103c]=_0x4b9233;}_0x2535e0=0x0;_0x32103c=0x0;for(var _0x36525d=0x0;_0x36525d<_0x3cc487['length'];_0x36525d++){_0x2535e0=(_0x2535e0+0x1)%0x100;_0x32103c=(_0x32103c+_0x11705d[_0x2535e0])%0x100;_0x4b9233=_0x11705d[_0x2535e0];_0x11705d[_0x2535e0]=_0x11705d[_0x32103c];_0x11705d[_0x32103c]=_0x4b9233;_0x400726+=String['fromCharCode'](_0x3cc487['charCodeAt'](_0x36525d)^_0x11705d[(_0x11705d[_0x2535e0]+_0x11705d[_0x32103c])%0x100]);}return _0x400726;}_0x2fe3['EljJEc']=_0x2d8473;_0x2fe3['ceBxFW']={};_0x2fe3['ZjFOYi']=!![];}var _0xe85098=_0x2fe3['ceBxFW'][_0x3116d3];if(_0xe85098===undefined){if(_0x2fe3['oxEcFc']===undefined){_0x2fe3['oxEcFc']=!![];}_0x2bfaab=_0x2fe3['EljJEc'](_0x2bfaab,_0x270de0);_0x2fe3['ceBxFW'][_0x3116d3]=_0x2bfaab;}else{_0x2bfaab=_0xe85098;}return _0x2bfaab;};const $=new Env(_0x2fe3('‮0','7Q4t'));!(async()=>{var _0x4e9e33={'qYwbo':_0x2fe3('‮1','SUPJ'),'xLHFL':'//yunonline/v1/jump','ZasCL':'Close','mUsTS':_0x2fe3('‫2',']C&3'),'MCpeY':'HTTP/1.1\x20200\x20OK','TGsBQ':function(_0x51710a,_0x5958a2){return _0x51710a!==_0x5958a2;},'iLVyN':function(_0x386cea,_0x155589){return _0x386cea>_0x155589;},'BlObq':_0x2fe3('‫3','P&Ck'),'ukrGn':'veBeW','UMBQb':_0x2fe3('‮4','%dw^'),'gjDYO':_0x2fe3('‫5','vEFF'),'UtlKF':function(_0x2a9e89,_0xcc763c){return _0x2a9e89===_0xcc763c;},'gNJXR':'Vmaxs'};if(_0x4e9e33[_0x2fe3('‫6','SAs[')](typeof $request,'undefined')){if(_0x4e9e33['iLVyN']($request[_0x2fe3('‫7','i2#D')]['indexOf'](_0x4e9e33[_0x2fe3('‫8','og7g')]),0x0)){let _0x4be0aa=_0x2fe3('‮9','UEAP');const _0x4a8497={'Connection':_0x4e9e33[_0x2fe3('‮a','UXtM')],'Content-Type':_0x4e9e33['mUsTS']};if($['isSurge']()||$[_0x2fe3('‮b','Cqy3')]()){$['done']({'response':{'status':0xc8,'headers':_0x4a8497,'body':_0x4be0aa}});}else if($[_0x2fe3('‮c',')XP%')]()){if(_0x4e9e33[_0x2fe3('‮d','bkt&')]===_0x4e9e33[_0x2fe3('‮e','gjXQ')]){let _0x601875=$response['headers']&&$response[_0x2fe3('‫f','cLck')]['Location']||'';if(_0x601875['match'](/https?:\/\/mp.weixin.qq.com\/s/)){$response[_0x2fe3('‮10','gjXQ')][_0x4e9e33[_0x2fe3('‮11','P&Ck')]]=$request[_0x2fe3('‮12','e8Mx')][_0x2fe3('‫13','og7g')](_0x4e9e33[_0x2fe3('‫14','3$xL')],_0x2fe3('‮15','gjXQ'));$[_0x2fe3('‮16',')XP%')]({'headers':$response['headers']});}else{$[_0x2fe3('‫17','5vuL')](_0x2fe3('‮18','Cqy3')+JSON['stringify']($response[_0x2fe3('‫19','*H&8')],null,0x2));}}else{$[_0x2fe3('‫1a','4E3N')]({'status':_0x2fe3('‮1b','5vuL'),'headers':_0x4a8497,'body':_0x4be0aa});}}}else if(_0x4e9e33[_0x2fe3('‮1c','It]N')](typeof $response,_0x4e9e33[_0x2fe3('‫1d','P&Ck')])){if(_0x4e9e33[_0x2fe3('‮1e','iD5d')](_0x4e9e33[_0x2fe3('‮1f','e8Mx')],_0x4e9e33['gNJXR'])){let _0x18b71b=$response['headers']&&$response[_0x2fe3('‮20','e^ul')][_0x4e9e33[_0x2fe3('‫21','9qOz')]]||'';if(_0x18b71b[_0x2fe3('‫22','e^ul')](/https?:\/\/mp.weixin.qq.com\/s/)){$response[_0x2fe3('‮23','5vuL')][_0x4e9e33[_0x2fe3('‮24','It]N')]]=$request[_0x2fe3('‮25','9N8e')][_0x2fe3('‮26','MUUb')](_0x2fe3('‮27','%dw^'),_0x2fe3('‮28','cXpY'));$[_0x2fe3('‫29','pTtv')]({'headers':$response[_0x2fe3('‫2a','Nls$')]});}else{$[_0x2fe3('‮2b','WUv3')](_0x2fe3('‮2c','ESxu')+JSON[_0x2fe3('‮2d','%dw^')]($response[_0x2fe3('‮2e','UEAP')],null,0x2));}}else{let _0x5b4944=_0x2fe3('‮2f','3$xL');const _0x555a87={'Connection':_0x4e9e33[_0x2fe3('‫30','DqSo')],'Content-Type':_0x4e9e33['mUsTS']};if($[_0x2fe3('‫31','og7g')]()||$['isLoon']()){$['done']({'response':{'status':0xc8,'headers':_0x555a87,'body':_0x5b4944}});}else if($[_0x2fe3('‫32','US$]')]()){$['done']({'status':_0x4e9e33[_0x2fe3('‮33','[I5L')],'headers':_0x555a87,'body':_0x5b4944});}}}}})()['catch'](_0x1dfb1a=>$['logErr'](_0x1dfb1a))[_0x2fe3('‫34','u@H8')](()=>$[_0x2fe3('‫35','R&hl')]());;_0xodF='jsjiami.com.v6';


function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`\ud83d\udd14${this.name}, \u5f00\u59cb!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}isShadowrocket(){return"undefined"!=typeof $rocket}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),a={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(a,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:i,...r}=t;this.got[s](i,r).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t.stack):this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
