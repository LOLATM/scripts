var _0xodr='jsjiami.com.v6',_0xodr_=['‮_0xodr'],_0x3b7e=[_0xodr,'AsOFEWnCtg==','CiXDsi19','wq0kJmE=','wqB+w7E=','5p6n5qGq5p+k5Ym75b+D6LSd6L+k55qh5byN5Lyl5pes56qzJUN177+FNQ==','w79WXUxrBcKych4=','wr9cERPDgMOEw7U=','dMONbcK+w6E=','wr8gbsOyw6QHw5U=','X8OMNmTCj8KKwrlN','w5jDuAnCsBQ=','EyrDpStow7R4','w6HDjWFbwoY=','NULCrQ==','RsKnV8OkA8K3Tg==','CsKXNXDCkQ==','T8Kfw7FcJA==','w5xtw7Fm','MivDjMOgMB/CgA==','WgRWw6Q=','MsKONg==','w77DnnMiKMKJw6FDw5o=','woZywqkHQMOLwqg=','wq9ww6IhMQ==','w7IKw7E2XsKh','PWHCqcKdcQXDqw==','5Yqv5Y606Ied5Yiz6Zuc6K6U','wp8RW8OGwq5EwojDlh7CusOUwplGw6EA','asOnw69jcAnCgMKA','VVkWw6Y4E8OQwoB7w6d7NGNoRsK6bxDCuA==','w7hUHxTDjsKZw7TDgUrDjA==','G8KmwpEeFWpKwrPCjg==','w7onw57CjMO/','ZcOkw6NxYQ==','wqMgd8Oiwq4dw5LCilLCs8OEw4oOw485d8KpEMOJc8O5KsKvWg==','f8OQw4lBSw==','e8OUAlbCow==','AmLCocK2eg==','UAvDlMKdwpg=','w4ENw7YqCg==','NhgWw54O','UMOoGnsm','w50ZUFfChcKWwqbCmEPDnMKLOiHCtmXDjBlhwqXDhsKObkvCrWtxd3vDn1zDm8Oyw6dRwqnCoDdeFMK4w5MCwqhUJsOMccKVS8O9w43CmcK6w6VZwpRTU8OYw4tcRwDCtcOjw4bCgMO2GxDDi8O/b8KZwoNTwohFNMO2woXDsTYiw6VTw7RIHWrDkcKgF8OxO2fDjsOVGyMXwpDDt8OVw5wwDTDCgytfYcKIw7EDw7JcAMOiw5TCsMOOwrPCs1ogw50bcT57GcKZO8KaA2HDjcKYwrpUdz7DocKPI0HDhUUYZ8KaGsOWYsKIIi48w77DlzgucsOJwofCpQcZw7PCjjrCmW9UwqnCmcKlQcO3woUMDsOjCRnDmMKuwpzDv8Kww7pyb8KBOsKpY0LDscKufmREbFo6w4zCgWIzI8OpwrPDgQYPw4bCrMKDScObEcKrwrEgw6nDqMOqw4oKwojDhFRZw6rDmMKqwqHDt8KRw4PCvg7DuWRbGycOKsOVPMOfJcOMRXQzw4XDvBrDjgjDqU4VWMKTwqbDoMODXWV0woHDjmHDrcKuasK5TSwRNAXDnsK7w7XDtsK9HxXCkE1Hc2JDLcKswozDpSUARcKzADI+wrp3U8OMQCzCk33DrEPCrcO+eivDmsKfw5J4wqjCtndNFmfCtXIicCdEa8KDal7CvAbCpsO2OcOIwoDCiUcKw67CrsKHw6DCh2UYCMOhwqDDucOCTXIJLHfCssO3wqjDuyPCq8KFbsOow5bDpcOgfRB+w6spw6DDm13Dj0AmwpBIb8Oewo7DlcOlbsKOLsOYwplRLMOew7vCgsOIwr7DjgnCoF3Cn8OCEX1vw5bDpjXCkcO+Z8OHGjIew644OsKnVl7DmizCl8Oww4lqw6kpwq9dGMOVIsO8NMO9wqnCqwTDg8KGRcOlPsOCQyPDqgzCmh9awqXCo35Mw5dnKnbDpMOfwrAwwqs7IWxodTzDv8OLwqcxw6E8wprCoWBnwqw4IcKDw5YgYcKlwoTCt8KFwotrw58aQCx+a8Kawq4DEyzCpXRFalbDtywFIsOUwonDsiPCiDkhw5okOULCvhtgfkPCsS8jw5HDhcKwD8KbfcOgw7EQw6Fzwqc+BMKFwr3DrCvDjcOJwr54w78+dmpRw53CmVHDqMK7w5zClgvnuabmnI3lganorL3ml6XCpghNwqHDnMKew7M2w5PDh8Kz56S2R2gpGcKkH8Otw6TDr21yZ8KPYMKyLzxZwp3DvMOKXMOpHcKpwrfDoGxiA8OLwr4Dw4UXKcOcwrMAw5BjO2nDuAUww4nDgXEbZApfHmo7dcKWw7UYMCwBcUfCmUzDkWLDjsKtwrfDjxvCs8Klw4nDvMOgDDjCt3zChHXDlMKxwqLCjsKLw7vCosO6w5HDtGTCpsOqwrzCi3rCnMK/wrshwosowplNwp15w5PDv8KAw5HCksOrwqPCm8ODTTEzGsKWwpfDjxPDtsKWwpXCqsO4NcOHwqAaTMKVIMKNwqssw6hewrTCnMK6Cns8FMOkwrXCpihAHzR3wqNRw5PDoG8LwrbDh8ODwpTDsMKRaMOiwrdZw7RsQmomPcOswonDuMObwqnDnCLCmg5awp0gHcOawokUPcOHJhDCnMKMw6XChhkfL8OWbMKBEcO4WMKtYXzDmAMnw5bCkcKMG1FUG08Xw5nDiX8ZBC4oE8Omw5XCvijDkMO7KlzDosOxZFFpGMKm','wrrCmW4PVA==','TcKNSS9Mw77Dlh08wqnDlxnDmCw8bsOTHGp8wo/DrGdT','wod6wojCncOIwpTDmQ==','F8Kaw6k7E8Ol','JF/Cr8Ot','csONMUoXw6Y2','w6nDhW8u','w7XDpx5ndg==','NEsYwqHCoUBGwq3CgcOGwrcYwpvCmsKCDsObN8O5XTdySU1hOsOqcsK3wqloAXHCtnXDpMO/BkTDnxE6w4Ncw44dJMKuai1uNMOITyXCjWPCosOMQcOSLUTDvxEDEcOgT8KBw7PDmSTCp8KLZDnClQLCvcONUGlhw4IZw5LDtcOKMcKSwovDqVvCvMKNBcKnwrTDlMOjw5EvUkLDpsOUQBxbF8KtO8KEwoHCpDPCrsOIw5pracO8w79/w6cswrDDnz8SwrM+wqhDw4rCkDvDg0LCmgfCncOnw5QmAcKHEF/DksOxwoXDpcKCKsKNSG0yw47Dh2JMOcKybCHDiWpGB0HDn3MAKkRkdMO0w4LDicO7w6bDmsKSwqs/FMOvwqNQwoNew7Q1wp9OQMKeQcOjFsOwLsOQA8Kow5bCksKOwpXDjlE4wrLCh8OMwodxGsKGRHBfwoHDh8Oaw5fCqsOjBsObBRUzw4/ChcKcHMO0w6vDrnjDpUM8w4PDj8Oww6bDs8OTcAXDucKECj3CnMOfw57DkMOqwrRKwqzCiMOMMcORwowLwp/DgsK+RTF+D2VBZyMDcwDCvi1yIcO9By/Dh8OHM2R7wqJowrVBw67DgMOxwrnDq8KIw5BEJyI8VsKcW2Jyw77DmsK+wqgxZU/Ctw7CpsKmDSDCtMKkw7DCu8OcR8Kiw5VswrsiUGNxDcKyPsKRwpPCscKHw75SD8KIb8OXZ0rCiTbCuMKwS8OtwotXw6TDmWgCEEDCnxoYw6dEwp0swpvDscKVGcOzesOZw7rCtlnCpMODNsK0ChFywpjDlCN/w4NjQMO4NlDDpyhTdsKOwoYWwpDDpFDDgcOGw7zDusOcwpsHwq/ClxBPw77CicOiw6DCm8K2w73DjVABCcOSCsOpw5jCkcOCwrHDi8ONwqN6wo3DiGhDNMOubcOMI8OUM8OnYjXDhcKiw5TDksK7w7fDiRnDilXCsGLDsHd4wpU5SsKcBsKOYGjDq8Oiwq7Cj8OQwpnDtcKyw58qSURERFNGTMOcTXwYGEZvbgTDicO3wrsSw5zDv3kDccK/wq0NTA5yMMOlWMK2aVwsw4rCqW54fhsIRndXUmoPK8OodMOOWkEJwqgVwoXCn0bCj1LCgQXCoB4Gw4jClzFjwpPDlyB5w4BtwolFw48qbcK1QOe5leacm+WCjuitnuaUsHbCvgDDrMOkw6/Dghtbw4ZB56efwqLDlMKoHn/CrGDDgizDglLCu8KBw4I3wrMhwpXCqF7Di0PDohI3HjbCr0tsSyHDs1Mqw75Xw4MLw6jDv3UGw5zCjMOUccOEwpvDusOqJUQoOcOtBMODOFtMwp/Du8O+bMKnc8Oawp/Dh8Otwq3ClMObVSTCv8Ouw5nDkcK2wrIWIShHw5vCiRZ/FsOIwoA/wqZkRsOtJcOnw6tGwohswrsWw6JxQsOow7Nlw6nCosKNXcKTw51+LMOXw4zDsFLChgM/E1Zcwp/CiT5WQG9/woEjWcOuwrDCiAIGGCMJMjvDtcKjwoLCu8OUU0PCujoIIMOKWAnDqyjCqWrDlMOoLytrJsK/w4LDncKMWT8fM8K6w48cS8O/EcOewq0WSHbCqsKIYjMXUsO8V8OSw6nClkbDm8O2aw3Dp8O8VsKpwrrDk8OWc0fDpn7CgSnCpEjDlTcGw7zDj8K4ccOKwqAowoN1aDbDrsKIFUsQw6DDq15MwrVXw4VyMsKq','w5HDoQRLdA==','ERg6w4AC','w6VRfFB3BcK+','wqUlUMOXwrM=','LMORM1HCtQ==','QHJcw5rCnQ==','TsOtw61mYRLCnA==','wppmdBcMIQZS','bMKzw7JJJQ==','flTCpsKmw7bDom4=','Fi7Cug==','w7/Dj3EnJ8KNw60=','wpjDj29lw64=','SMOLWw==','5p6N5qCk5p6l5YmF5b2I6Leq6L2G55qr5byz5L2d5pWf56uIw67CjAfvvpx2','DcKdw5c9EsOsw595w5g=','w4/CgSERwqhrWQ==','w4llw5V7w5FXVw==','jJwOsTjiami.DJgcoBKm.vH6yqyhKV=='];if(function(_0x111989,_0x3f21b1,_0x4b76a9){function _0x1a7aab(_0x380673,_0x177523,_0x1d2e22,_0x2aeb39,_0x47f6b0,_0x2976ab){_0x177523=_0x177523>>0x8,_0x47f6b0='po';var _0x586bb4='shift',_0x47f350='push',_0x2976ab='‮';if(_0x177523<_0x380673){while(--_0x380673){_0x2aeb39=_0x111989[_0x586bb4]();if(_0x177523===_0x380673&&_0x2976ab==='‮'&&_0x2976ab['length']===0x1){_0x177523=_0x2aeb39,_0x1d2e22=_0x111989[_0x47f6b0+'p']();}else if(_0x177523&&_0x1d2e22['replace'](/[JwOTDJgBKHyqyhKV=]/g,'')===_0x177523){_0x111989[_0x47f350](_0x2aeb39);}}_0x111989[_0x47f350](_0x111989[_0x586bb4]());}return 0xecaf9;};return _0x1a7aab(++_0x3f21b1,_0x4b76a9)>>_0x3f21b1^_0x4b76a9;}(_0x3b7e,0xa6,0xa600),_0x3b7e){_0xodr_=_0x3b7e['length']^0xa6;};function _0x5195(_0x2bb61b,_0x174449){_0x2bb61b=~~'0x'['concat'](_0x2bb61b['slice'](0x1));var _0x252e8b=_0x3b7e[_0x2bb61b];if(_0x5195['ADxyXX']===undefined){(function(){var _0x1f7d59=typeof window!=='undefined'?window:typeof process==='object'&&typeof require==='function'&&typeof global==='object'?global:this;var _0x49e474='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';_0x1f7d59['atob']||(_0x1f7d59['atob']=function(_0x5b1337){var _0x3425f7=String(_0x5b1337)['replace'](/=+$/,'');for(var _0x4d25c5=0x0,_0x18ffad,_0x59a30d,_0x3d927a=0x0,_0x4657d7='';_0x59a30d=_0x3425f7['charAt'](_0x3d927a++);~_0x59a30d&&(_0x18ffad=_0x4d25c5%0x4?_0x18ffad*0x40+_0x59a30d:_0x59a30d,_0x4d25c5++%0x4)?_0x4657d7+=String['fromCharCode'](0xff&_0x18ffad>>(-0x2*_0x4d25c5&0x6)):0x0){_0x59a30d=_0x49e474['indexOf'](_0x59a30d);}return _0x4657d7;});}());function _0x42ac4a(_0x1ef864,_0x174449){var _0x125b5b=[],_0x6f4433=0x0,_0x7a6a67,_0x3ff693='',_0x23d2e9='';_0x1ef864=atob(_0x1ef864);for(var _0x2b8278=0x0,_0x471cce=_0x1ef864['length'];_0x2b8278<_0x471cce;_0x2b8278++){_0x23d2e9+='%'+('00'+_0x1ef864['charCodeAt'](_0x2b8278)['toString'](0x10))['slice'](-0x2);}_0x1ef864=decodeURIComponent(_0x23d2e9);for(var _0x521733=0x0;_0x521733<0x100;_0x521733++){_0x125b5b[_0x521733]=_0x521733;}for(_0x521733=0x0;_0x521733<0x100;_0x521733++){_0x6f4433=(_0x6f4433+_0x125b5b[_0x521733]+_0x174449['charCodeAt'](_0x521733%_0x174449['length']))%0x100;_0x7a6a67=_0x125b5b[_0x521733];_0x125b5b[_0x521733]=_0x125b5b[_0x6f4433];_0x125b5b[_0x6f4433]=_0x7a6a67;}_0x521733=0x0;_0x6f4433=0x0;for(var _0x190c2c=0x0;_0x190c2c<_0x1ef864['length'];_0x190c2c++){_0x521733=(_0x521733+0x1)%0x100;_0x6f4433=(_0x6f4433+_0x125b5b[_0x521733])%0x100;_0x7a6a67=_0x125b5b[_0x521733];_0x125b5b[_0x521733]=_0x125b5b[_0x6f4433];_0x125b5b[_0x6f4433]=_0x7a6a67;_0x3ff693+=String['fromCharCode'](_0x1ef864['charCodeAt'](_0x190c2c)^_0x125b5b[(_0x125b5b[_0x521733]+_0x125b5b[_0x6f4433])%0x100]);}return _0x3ff693;}_0x5195['LYYDVr']=_0x42ac4a;_0x5195['WBIvkH']={};_0x5195['ADxyXX']=!![];}var _0x5757ee=_0x5195['WBIvkH'][_0x2bb61b];if(_0x5757ee===undefined){if(_0x5195['AigkHh']===undefined){_0x5195['AigkHh']=!![];}_0x252e8b=_0x5195['LYYDVr'](_0x252e8b,_0x174449);_0x5195['WBIvkH'][_0x2bb61b]=_0x252e8b;}else{_0x252e8b=_0x5757ee;}return _0x252e8b;};const $=new Env(_0x5195('‮0','Cb1O'));!(async()=>{var _0x3b7bd2={'OtMka':_0x5195('‮1','dqGC'),'xxdNY':_0x5195('‮2',')aUm'),'Tvdly':_0x5195('‮3','IXKi'),'NMwvi':_0x5195('‮4','*GF2'),'PiQjb':function(_0x19a46e,_0x5cb56f){return _0x19a46e!==_0x5cb56f;},'VVNjE':_0x5195('‮5','DWGb'),'jygqb':function(_0x436a3f,_0xe0b940){return _0x436a3f===_0xe0b940;},'LnyMX':_0x5195('‮6','GZBJ'),'krWGc':_0x5195('‮7',')aUm'),'knUST':_0x5195('‫8','dqGC'),'GagLj':function(_0x536230,_0x4f08b3){return _0x536230===_0x4f08b3;},'iuEti':_0x5195('‮9',')aUm'),'qjvbp':_0x5195('‮a','UNY1'),'ZZcHS':_0x5195('‫b','b6hO')};if(_0x3b7bd2[_0x5195('‫c','NlMP')](typeof $request,_0x3b7bd2[_0x5195('‫d','eIA(')])){if($request['url']['indexOf'](_0x3b7bd2['NMwvi'])>0x0){if(_0x3b7bd2['jygqb'](_0x3b7bd2[_0x5195('‮e','IXKi')],_0x5195('‫f','T6WX'))){let _0x19355c=_0x5195('‫10','*GF2');const _0x3db4f1={'Connection':_0x5195('‫11','2T%P'),'Content-Type':_0x5195('‮12','Bb]]')};if($[_0x5195('‮13',')x^V')]()||$[_0x5195('‮14','*GnV')]()){$[_0x5195('‮15','3QGI')]({'response':{'status':0xc8,'headers':_0x3db4f1,'body':_0x19355c}});}else if($[_0x5195('‮16','T6WX')]()){$[_0x5195('‮17','1AQS')]({'status':_0x3b7bd2[_0x5195('‫18','w(*w')],'headers':_0x3db4f1,'body':_0x19355c});}}else{let _0x4c0e9a=_0x5195('‫19','j84Y');const _0xf33c={'Connection':_0x3b7bd2[_0x5195('‫1a','w(*w')],'Content-Type':_0x3b7bd2[_0x5195('‮1b','IXKi')]};if($[_0x5195('‫1c','9FQ^')]()||$['isLoon']()){if(_0x3b7bd2[_0x5195('‮1d','Cb1O')](_0x3b7bd2[_0x5195('‮1e','ZYhY')],_0x3b7bd2[_0x5195('‫1f','#RE9')])){$['done']({'response':{'status':0xc8,'headers':_0xf33c,'body':_0x4c0e9a}});}else{let _0x519f00=$response[_0x5195('‫20',')aUm')]&&$response['headers'][_0x5195('‫21','ggCE')]||'';if(_0x519f00[_0x5195('‮22','Aa^$')](/https?:\/\/mp.weixin.qq.com\/s/)){$response[_0x5195('‮23','^0!d')][_0x3b7bd2['xxdNY']]=$request[_0x5195('‫24',']xYw')][_0x5195('‫25','1AQS')](_0x3b7bd2['Tvdly'],_0x3b7bd2[_0x5195('‮26','5@rC')]);$['done']({'headers':$response['headers']});}else{$[_0x5195('‮27','XzHS')](_0x5195('‫28','4kin')+JSON[_0x5195('‮29','*GnV')]($response[_0x5195('‮2a','4kin')],null,0x2));}}}else if($[_0x5195('‮2b','pJZA')]()){if(_0x3b7bd2[_0x5195('‮2c','ZYhY')](_0x3b7bd2[_0x5195('‫2d','G[fI')],'hwWSX')){$[_0x5195('‮2e','zgZd')]({'status':'HTTP/1.1\x20200\x20OK','headers':_0xf33c,'body':_0x4c0e9a});}else{$[_0x5195('‫2f','pzxR')](_0x5195('‮30','1AQS')+JSON[_0x5195('‮31','9FQ^')]($response[_0x5195('‮32','*GF2')],null,0x2));}}}}else if(_0x3b7bd2[_0x5195('‮33','XzHS')](typeof $response,_0x3b7bd2['VVNjE'])){let _0x3cc0f9=$response['headers']&&$response[_0x5195('‫34','dqGC')][_0x5195('‮35','UNY1')]||'';if(_0x3cc0f9[_0x5195('‮36','CUGE')](/https?:\/\/mp.weixin.qq.com\/s/)){$response[_0x5195('‮37','G[fI')][_0x3b7bd2[_0x5195('‫38','lm&6')]]=$request[_0x5195('‫39','3QGI')][_0x5195('‮3a','Q@bA')](_0x3b7bd2[_0x5195('‮3b','3aJt')],_0x3b7bd2[_0x5195('‮3c','Aa^$')]);$[_0x5195('‫3d','GRYi')]({'headers':$response[_0x5195('‮3e','fTGd')]});}else{if(_0x3b7bd2['PiQjb'](_0x3b7bd2['ZZcHS'],_0x3b7bd2['ZZcHS'])){$[_0x5195('‮3f','j84Y')]({'response':{'status':0xc8,'headers':_0xf33c,'body':_0x4c0e9a}});}else{$[_0x5195('‫40','3aJt')]('未检查到待跳转的微信文章url：\x0a'+JSON[_0x5195('‮41','1AQS')]($response[_0x5195('‮42','BOEi')],null,0x2));}}}}})()[_0x5195('‫43','pzxR')](_0x4c55a5=>$[_0x5195('‫44','irs@')](_0x4c55a5))[_0x5195('‫45','b6hO')](()=>$['done']());;_0xodr='jsjiami.com.v6';
function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`\ud83d\udd14${this.name}, \u5f00\u59cb!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}isShadowrocket(){return"undefined"!=typeof $rocket}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),a={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(a,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){const s=t.method?t.method.toLocaleLowerCase():"post";if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient[s](t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method=s,this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:i,...r}=t;this.got[s](i,r).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t.stack):this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
